
pkgname=libmirage
pkgver=2.1.1
pkgrel=2
pkgdesc="CD-ROM image (B6T/CCD/CDI/CUE/ISO/MDS/NRG/TOC) access library"
arch=('x86_64')
url="http://cdemu.sourceforge.net/"
license=('GPL')
depends=('glib2' 'libsamplerate' 'zlib' 'bzip2' 'shared-mime-info')
makedepends=('bison' 'flex' 'cmake' 'gobject-introspection')
source=("http://downloads.sourceforge.net/cdemu/$pkgname-$pkgver.tar.bz2"
        'gtkdoc.diff'
        'xml.patch')
options=('!libtool')
md5sums=('be5349fff21c2999f324b9f86190ed07'
         '736d6fea093d776e0891580c484dd4a7'
         '838c4c485ff9dd8c9efda74148bdc929')

build() {
  cd $srcdir/$pkgname-$pkgver 
  patch -p2 -i $srcdir/gtkdoc.diff
  patch -p2 -i $srcdir/xml.patch
  
  mkdir build
  cd build
  cmake .. \
    -DCMAKE_BUILD_TYPE=Release \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DCMAKE_INSTALL_LIBDIR=lib \
    -DWITH_GTKDOC_ENABLED=off \
    -DPOST_INSTALL_HOOKS:BOOL=OFF
  make
}

package() {
  cd $srcdir/$pkgname-$pkgver/build
  
  make DESTDIR=$pkgdir install
}
