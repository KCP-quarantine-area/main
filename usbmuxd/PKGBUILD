
pkgname=usbmuxd
pkgver=1.0.8
pkgrel=4
pkgdesc="A USB multiplexing daemon."
url="http://sukimashita.com/"
arch=('x86_64')
license=('GPL')
depends=('glib2' 'libxml2')
makedepends=('git' 'cmake')
install='usbmuxd.install'
source=("git+http://cgit.sukimashita.com/usbmuxd.git"
	'usbmuxd.service')
md5sums=('SKIP'
         'dae0660f972510a6483992b5b81e1b5a')

build() {
    cd ${srcdir}

    cp -r ${srcdir}/usbmuxd ${srcdir}/usbmuxd-build
    cd ${srcdir}/usbmuxd-build

    cmake ./ -DCMAKE_INSTALL_PREFIX:PATH=/usr -DLIB_SUFFIX=""
    make -j2 

}

package() {
    cd ${srcdir}/usbmuxd-build
    make DESTDIR=${pkgdir} install  
	
    # fix udev dir being hardcoded
    mv ${pkgdir}/lib/udev ${pkgdir}/usr/lib/
    rmdir ${pkgdir}/lib
    install -D -m644 ${srcdir}/usbmuxd.service ${pkgdir}/usr/lib/systemd/system/usbmuxd.service
}